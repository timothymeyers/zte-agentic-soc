# Agentic SOC Layer: AI Agents in Modern Security Operations

In a modern **AI-enhanced Security Operations Center (SOC)** architecture, the **Agentic SOC Layer** comprises specialized AI-driven agents that collaboratively handle key security functions. These agents, built with platforms like **Azure AI Foundry**, work in concert to augment human analysts – each focusing on a specific set of tasks while sharing context with the others. Below is a quick overview of the four primary agents in this layer and their roles:

*   **Alert Triage Agent** – Prioritizes and correlates incoming alerts (e.g. from SIEM/XDR systems) using AI, filtering false positives and surfacing the most critical incidents first. It analyzes alert details and context (such as content and intent) to assess risk, providing explanations or summaries for why an alert is high priority. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041)
*   **Threat Hunting Agent** – Proactively searches for hidden threats or anomalies in security telemetry. It enables analysts to perform complex threat hunts using natural language or automated analytics, generating queries (e.g. KQL) and uncovering signals that might evade static detections. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)
*   **Incident Response Agent** – Automates containment and remediation actions when an incident is confirmed. It orchestrates response playbooks across tools (isolating endpoints, disabling accounts, etc.), often recommending or executing steps in line with the organization’s standard procedures. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)
*   **Threat Intelligence Agent** – Gathers and distills threat intelligence from external and internal sources to provide context on emerging threats. It supplies relevant IOCs (Indicators of Compromise), threat actor tactics, or vulnerability alerts, and integrates this intel into SOC workflows (for example, enriching alerts or informing hunts). [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)

These agents do not operate in isolation – an **Orchestration Layer** (using Azure Functions, Logic Apps, or an AI agent framework) manages their collaboration, context-sharing, task routing, and escalation. The result is a cohesive **“digital SOC team”**: each agent handling its specialty while working together (and with human oversight) to handle complex attack scenarios faster and more effectively than traditional methods.

***

## Alert Triage Agent

**Role & Responsibilities:** The Alert Triage Agent serves as the front-line filter and investigator for incoming security alerts. In a typical SOC, analysts face a deluge of alerts each day; this agent uses AI to **automate the triage process** by reading and interpreting each alert, assessing its likely severity, and deciding which alerts merit immediate attention. Its core tasks include: [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041)

*   **Alert Prioritization:** Analyze alert content (e.g. what data was involved, which user or system triggered it) and intent to judge risk level. High-risk alerts (e.g. potential data breach, active malware on a critical server) get flagged as “Needs attention” whereas low-risk or benign alerts are deprioritized. The agent bases these decisions on organizational risk tolerance and parameters set by the SOC team (for example, focusing on alerts related to critical assets or sensitive data). [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041)
*   **Correlation & Deduplication:** Group related alerts together to identify incidents. For instance, if multiple alerts across an hour all pertain to the same user account behaving suspiciously, the agent can merge them into a single potential incident for investigation. This reduces duplication and alert fatigue.
*   **False Positive Reduction:** Using generative AI and knowledge of normal patterns, the agent can recognize common benign events. For example, if an alert is triggered by an automated backup process that is known and approved, the agent might mark it as low priority or auto-close it (with an explanation) so analysts don’t waste time. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041)
*   **Enrichment & Summary:** For alerts deemed important, the agent provides a summary and reasoning. It might pull in additional context – e.g. attaching user identity info, asset importance, or relevant threat intelligence – to explain why an alert is high priority. It essentially writes a “brief” for the analyst: *“This alert indicates possible credential theft on admin account X, seen by multiple failed logins from unusual locations.”* The agent’s explanation is transparent so the team can understand the logic behind the categorization. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041)

**Data Sources & Dependencies:** The Alert Triage Agent ingests data from **Microsoft Sentinel** (SIEM) and other security tools that generate alerts. It uses Sentinel’s incident/alert feed as a primary input, including alerts from **Microsoft Defender XDR** (for endpoint, email, identity, and cloud app threats) aggregated via Sentinel or the Microsoft Graph Security API. The agent might also reference asset inventory or user directories (e.g. Microsoft Entra ID) to gauge the criticality of the system/user involved in an alert. For its AI capabilities, it leverages **Azure OpenAI** (part of Security Copilot’s backend) to interpret alert descriptions and logs in natural language. Dependency-wise, the agent needs access to the organization’s security log data and relevant context (like classification of data involved, if available from Purview for a DLP alert). [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)

**Interactions & Workflow:** Typically, the orchestration layer triggers the Alert Triage Agent whenever new alerts come in (or continuously pulls from the queue). The agent processes each alert or batch of alerts and produces a prioritized list or labeled queue (e.g. tagging alerts as “Critical – immediate response,” “Monitor,” or “Benign”). Critical alerts can trigger downstream actions automatically: the agent can forward them to the **Incident Response Agent** for containment or notify a human analyst if policy dictates. It might also call on the **Threat Intelligence Agent** for enrichment – for example, if an alert contains an IP address or file hash, the triage agent could query the threat intel agent to get reputation or threat context, which it includes in its analysis. The triage agent’s output (post-analysis alerts) may be fed back into Sentinel as updated incident metadata or into a ticketing system.

**Customization & Extension:** This agent can be tailored to an organization’s needs. The SOC can configure **natural language prompts or parameters** to guide its focus. For instance, a data security admin could instruct the agent to *“prioritize any alerts involving Project Obsidian intellectual property”* (as mentioned in a Microsoft Purview scenario). The agent would then learn to rank those alerts higher and provide rationale referencing the IP data. Likewise, feedback from analysts is used to fine-tune the agent’s logic: if the SOC marks certain alerts as false positives, the agent adapts over time to de-prioritize similar alerts in the future. Organizations can also extend the agent to ingest alerts from **third-party systems** (e.g., a cloud firewall or an on-prem IDS) by connecting those sources to Sentinel or via custom connectors – the agent’s AI logic can apply across any alerts once data is available. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041)

*Example:* Microsoft’s preview of **Phishing Triage Agent** (a specialized alert triage agent for phishing) demonstrated the power of such automation. It **autonomously handles user-reported phishing emails**, classifying and closing out false alarms and escalating only the real threats. Early results showed it identified **6.5× more malicious emails** and improved verdict accuracy by **77%**, freeing analysts to spend 53% more time on genuine threats. This illustrates how an Alert Triage Agent can dramatically boost efficiency: by catching more true incidents and filtering noise, it ensures the SOC addresses the most critical issues first. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)

***

## Threat Hunting Agent

**Role & Responsibilities:** The Threat Hunting Agent is an AI-driven assistant that augments the SOC’s proactive exploration of potential threats. Traditional threat hunting involves senior analysts formulating hypotheses (e.g., “Perhaps an attacker who phished one user has accessed others”) and writing complex queries or scripts to sift through logs. This agent makes hunting **more accessible and faster** by handling much of the heavy lifting in data querying and pattern recognition. Key responsibilities: [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)

*   **Natural Language Hunting:** Analysts can interact with the Threat Hunting Agent through natural language commands or questions (via a chat interface or Copilot). For example, an analyst might ask, “**Show me if any other machines communicated with the suspicious IP address from yesterday’s incident**.” The agent translates this into the appropriate log queries (e.g., KQL in Sentinel) automatically. This lowers the barrier for less-experienced staff to perform hunts, as they don’t need deep KQL or scripting expertise – the agent acts as a “translator” and query writer. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/), [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)
*   **Automated Anomaly Detection:** The agent can continuously run analytics to spot anomalies that weren’t caught by existing alerts. It might employ unsupervised ML models or advanced heuristics to flag unusual patterns (e.g., a spike in failed logins on a normally quiet service, or a rare process name running on multiple endpoints). Essentially, it looks for **“unknown threats”** by identifying outliers in the data. Microsoft’s Security Copilot, for instance, can generate custom alerts on the fly when it sees suspicious patterns across telemetry – this concept is similar to a hunting agent that dynamically discovers issues and generates an alert or report. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)
*   **Investigation Guidance:** During incident investigations, the Threat Hunting Agent assists by pivoting through related data. If an initial incident is being studied (say a malware infection on one server), the agent can automatically hunt for related signs: “Did this malware appear on any other server? Did the compromised user account perform any anomalous actions elsewhere?” It will follow the threads of an investigation, pulling logs from endpoints, network devices, identity systems as needed to build a more complete picture. This ensures that hidden facets of an attack (like lateral movement or secondary payloads) are uncovered concurrently with the main incident response.
*   **Comprehensive Data Coverage:** The agent can query across multiple data repositories: not only Sentinel logs, but also cloud service logs, identity logs (Azure AD sign-ins), and even third-party sources if integrated. It correlates across these to find connections that a single product’s alert might miss. For example, it might tie together a subtle link: a strange Azure AD login, followed by a peculiar API call in an Azure subscription, that together indicate an attacker hopping from on-prem to cloud. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)

**Data Sources & Dependencies:** The Threat Hunting Agent relies on **large volumes of telemetry**. In Azure-centric environments, this means querying the **Azure Monitor / Log Analytics workspace** behind Microsoft Sentinel, where logs from various sources (firewalls, VMs, Office 365, DNS, etc.) are aggregated. It also taps into **Microsoft Defender data** (through Defender for Endpoint’s raw event timelines, Defender for Cloud Apps logs, etc.) and **Entra ID** (Azure AD) logs for identity-related signals. If the organization uses a data lake or **Microsoft Fabric** for security data, the agent can utilize that for scalable analysis. The dependency on Azure OpenAI or similar ML models is critical for the NL query interface and for anomaly detection logic. In some implementations, this agent might also use **Azure ML** trained models (for example, a model to detect beaconing communication or a model for user behavior analytics). Additionally, it can incorporate external data like threat intelligence as hunt leads (e.g., if the Threat Intelligence Agent provides a new indicator, the hunting agent will search for it in historical logs). [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)

**Interactions & Workflow:** This agent often operates in two modes: *interactive* (human-driven) and *automatic* (continuous or orchestrated). In interactive mode, a human analyst engages with the Threat Hunting Agent via a Copilot interface or chatbot to ask questions and refine search results. The agent might return findings, then the analyst can ask follow-ups (“Filter those results to only show admins” or “What time did that occur?”) – effectively, the agent and analyst collaborate in real-time. In automatic mode, the SOC can schedule the agent to run periodic hunts (say nightly scans for specific anomalies) or the orchestration layer can trigger it in response to certain events. For example, after an Alert Triage Agent flags a possible malware outbreak, the orchestrator can prompt the Threat Hunting Agent: “Investigate if this malware or related activity appears elsewhere in the network.” The Threat Hunting Agent might then run a suite of queries (for file hashes, C2 domains, lateral movement attempts) and report back. It could create new alert objects or an investigation report in Sentinel with any suspicious findings, effectively escalating them to incidents if needed. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)

Crucially, the Threat Hunting Agent shares information with other agents: if it finds additional compromised hosts or accounts, it can notify the **Incident Response Agent** to take action on those. Conversely, it might take hunting cues from the **Threat Intelligence Agent** (e.g., “hunt for any usage of vulnerability XYZ in our logs” if intel reports a new exploit). Through orchestration, this agent ensures that *no stone is left unturned* during an incident – it extends the scope of analysis beyond the initial triggers.

**Customization & Extension:** Organizations can extend the Threat Hunting Agent by adding hunting modules or tailoring its knowledge base. For instance, if there are custom applications emitting logs, the agent’s logic can be updated to understand those log formats and include them in searches. Using **Copilot’s NL2KQL** capabilities, the agent can be taught synonyms or custom query patterns (perhaps the company has specific codewords or project names that should raise flags). The agent’s ML models for anomaly detection can also be retrained or tuned with organization-specific data to reduce false positives. From an integration standpoint, you could incorporate third-party data sources like **CrowdStrike** or **Palo Alto** logs via Sentinel or Graph API, and the agent will automatically cover those in its hunts as well. The agent’s behavior can be scripted in part by playbooks; for example, a Logic App could instruct: *“If any admin credential misuse is detected by the hunting agent, automatically notify the SOC channel.”* Overall, the Threat Hunting Agent is a flexible AI 'detective' that can evolve as new data sources or threat tactics emerge. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)

***

## Incident Response Agent

**Role & Responsibilities:** The Incident Response (IR) Agent is responsible for **automating and accelerating the containment, eradication, and recovery steps** of incident response. When a security incident is confirmed – whether by the Alert Triage Agent or a human analyst – this agent springs into action to handle the incident or assist responders. Its key functions include:

*   **Containment Actions:** The IR Agent can perform immediate containment measures to stop an active threat. Examples: isolating a compromised host from the network (using Microsoft Defender for Endpoint’s machine isolation capability), disabling a suspected breached user account in Microsoft Entra ID, or blocking malicious IP addresses at the firewall/Azure NSG level. These actions are executed via integration with security tools’ APIs or through SOAR (Security Orchestration, Automation, and Response) playbooks. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)
*   **Threat Eradication & Remediation:** After containment, the agent helps remove the threat and fix vulnerabilities. It might trigger a malware scan or memory dump on an affected machine, reset passwords for impacted accounts, or apply a missing security patch to systems (if a known vulnerability was exploited). Some of these steps can be automated fully, while others might be presented as recommendations for an analyst to approve (depending on the org’s comfort with automation).
*   **Incident Analysis & Documentation:** As it works, the IR Agent also compiles an incident timeline and notes. It uses AI to summarize what occurred and what actions were taken. Microsoft’s Security Copilot can reconstruct an analyst’s investigation steps into clear notes; similarly, the IR Agent keeps a log of containment actions and findings. This serves both as a real-time briefing for stakeholders and as documentation for post-incident review. For example, the agent might output: *“10:32PM: Isolated host HR-Server-01. 10:33PM: Disabled user Alice.Adams. 10:35PM: Retrieved malware hash and identified it as Ransom.XYZ variant.”* [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)
*   **Orchestrating Recovery:** Post-attack, the agent can assist in restoring systems. It might coordinate with backup solutions to restore data, or with configuration management tools to rebuild a clean machine. It ensures that any backdoors left by attackers are removed (for instance, verifying that malicious scheduled tasks or cloud credentials created by the attacker have been eliminated).

**Data Sources & Dependencies:** To make decisions and take actions, the IR Agent needs connectivity to the relevant security infrastructure. It relies on incident context from **Microsoft Sentinel** (incident details, affected entities) and telemetry from Microsoft Defender XDR (to gather the latest status of a device or user). For example, it may query Defender for Endpoint for the list of processes running on a machine before deciding to kill a malicious process. The agent uses **SOAR capabilities** – in Azure, this means integration with **Sentinel playbooks (Logic Apps)** or direct API calls to services like Defender, Microsoft Graph (for user directory actions), Azure Resource Manager (for cloud resource isolation), and even third-party systems (via connectors). Azure Functions may also be used for custom containment scripts (if very specific procedures are required). For its decision support, the IR Agent can leverage Azure OpenAI in a limited way – e.g., to **suggest remediation steps** based on similar past incidents or to interpret unusual patterns (though most IR actions are rule-based). Another important dependency is access to the organization’s **Standard Operating Procedures (SOPs)** and compliance requirements. The agent can be configured with these policies (or have them uploaded to a knowledge base) so that its actions align with what the organization permits. For instance, if policy says “for critical servers, get approval from IT manager before isolation,” the agent will know to escalate for approval rather than isolate immediately. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)

**Interactions & Workflow:** The Incident Response Agent is often invoked after an alert has been triaged and escalated. The orchestration layer triggers it with the relevant incident ID or details. From there, the agent may operate in a loop of *analyse >> act >> verify*. It might first gather additional info: ask the Threat Intelligence Agent for intel on an identified malware (to inform whether it should quarantine other assets), or query the Threat Hunting Agent to see if similar issues are occurring elsewhere (so it can contain those too). Then it proceeds to containment actions. It can work in tandem with human responders – for example, it could automatically isolate a machine and then post a message to the SOC team’s Teams channel: “Isolated host HR-Server-01 due to detected ransomware. Approve to push company-wide password reset?” – awaiting a human go-ahead for broader actions. The Orchestration Layer manages these hand-offs, ensuring that if the IR Agent needs approval or hits an unexpected situation (like an API failing), the issue is raised for human intervention.

During complex incidents, the IR Agent might coordinate multiple actions across different domains. Consider a multi-stage attack: the agent could simultaneously ensure cloud threats are contained (revoking a stolen OAuth token on Azure, for example) while also cleaning up on-prem systems. It interacts with the Alert Triage Agent by receiving the initial hand-off of an incident, and with the Threat Hunting Agent by giving it a heads-up of what indicators to search for (e.g., *“I’ve found malware hash X, see if it’s anywhere else”*). The agent also feeds information to the Threat Intelligence Agent post-incident – such as new IOCs discovered – so that intel can be updated.

**Customization & Extension:** The IR Agent must be tailored to each organization’s environment. New **playbooks** can be added to handle different incident types (e.g., a playbook for “ransomware outbreak” vs “insider data theft” might differ). Azure’s Logic Apps makes it relatively straightforward to plug in new actions or approvals into the agent’s workflow. Furthermore, companies can integrate their own tools: if they use a third-party EDR or a custom network segmentation tool, the agent can be extended to call those APIs during response. A critical aspect is alignment with internal procedures – using Security Copilot’s feature to ingest **internal SOP documents**, the agent can ensure its recommended actions match the company’s compliance and legal guidelines. For example, if working in a government SOC, it would know to follow incident reporting requirements and not to delete certain data without approval. Another extension avenue is to broaden the agent’s knowledge of recovery steps: integrating with ITSM systems like ServiceNow to create tickets or with configuration management databases (CMDB) to know system dependencies before pulling a plug. Essentially, the IR Agent can start simple (contain obvious threats automatically) and progressively be enriched with more decision logic and connections, potentially moving towards **autonomous remediation** for routine incidents. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)

***

## Threat Intelligence Agent

**Role & Responsibilities:** The Threat Intelligence (TI) Agent acts as the SOC’s eyes and ears on the broader threat landscape, as well as a librarian of internal threat knowledge. Its primary duty is to **bring in relevant threat insights and make them actionable for the SOC**. Key functions include:

*   **Threat Data Ingestion:** The TI Agent automatically gathers intel from multiple sources – e.g., threat feeds (commercial or open-source), reports on hacker group activity, vulnerability announcements, and even dark web monitoring results. Microsoft’s own implementation provides a *Threat Intelligence Briefing Agent* that delivers **daily tailored briefings**, synthesizing Microsoft’s global threat intel with organization-specific context. This means the agent might pull the latest from Microsoft Threat Intelligence (which could include millions of signals from worldwide telemetry, reports on active campaigns like those by nation-state actors) and filter it to what matters for the organization (for instance, highlighting “a new ransomware technique observed in attacks on government agencies” for a government SOC). [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)
*   **Alert/Incident Enrichment:** When the SOC is investigating an alert or incident, the TI Agent provides context about any indicators involved. If an alert includes an IP address, domain, file hash, or even a specific malware name, the agent will lookup what is known about it. It can tell the team: *“This IP has been associated with the Conti ransomware group as of last week”* or *“The malware MD5 hash matches a variant of Hades malware per VirusTotal”*. This enrichment can dramatically speed up analysis by immediately answering “have we seen this threat before, and what is it known to do?”.
*   **Threat Alerts & Advisories:** The agent doesn’t just react; it also **proactively alerts the SOC about new threats relevant to them**. For example, if a critical new vulnerability (zero-day) is disclosed in a product the organization uses, the TI Agent can flag this along with recommended actions (patch or mitigation guidance). Or if threat intel warns of a phishing campaign targeting the industry, the agent can notify the SOC to be on high alert. Essentially, it bridges external intelligence to internal awareness.
*   **Knowledge Base & Lessons Learned:** Over time, the TI Agent can build a knowledge repository of threats and past incidents. It can store details of previous attacks the organization experienced, the TTPs (Tactics, Techniques, Procedures) used, and how they were resolved. Later, if a similar pattern arises, the agent can draw parallels. (E.g., “This looks similar to incident #123 from March, which was linked to XYZ threat actor.”) It uses AI search over documentation and incident records to answer questions for analysts. Microsoft’s Security Copilot ecosystem facilitates this with a **security knowledge model**, and the TI Agent would be a key consumer and contributor to that knowledge.

**Data Sources & Dependencies:** The TI Agent typically integrates with both **external and internal data sources**. External sources might include Microsoft’s threat intelligence feed (providing data on billions of signals, known bad IPs, emerging attacker tools, etc.), open-source intelligence feeds (like feeds of new vulnerabilities or malware indicators), industry-specific intel sharing communities (such as an ISAC), and government CERT advisories. It could also tap into threat intel platforms like MISP or commercial feeds like Recorded Future, depending on what the organization uses. On the internal side, it uses data from Sentinel’s **Threat Intelligence Indicators** (Sentinel has a built-in TI repository where imported indicators are stored and matched against logs) and can ingest any internal honeypot or research findings the organization produces. The agent relies on **Azure AI (OpenAI and Search)** to process unstructured intel – for example, reading a PDF threat report and extracting key points. Cognitive search might index large volumes of threat reports so the agent can quickly retrieve specific info (say, “all IOCs related to Snake malware”). Another dependency is that it knows the organization’s environment context: linking with asset inventory and vulnerability scanners (like Microsoft Defender Vulnerability Management) to know which systems or software might be affected by a given threat.

**Interactions & Workflow:** The Threat Intelligence Agent works both independently and responsively:

*   **Independently:** It generates periodic intelligence summaries (daily or weekly briefings). For instance, each morning it might post to a Teams channel a summary: “Top 5 new threats: 1) New phishing campaign using COVID-19 lures targeting government staff – no related activity detected internally; 2) Critical vuln in Exchange Server – 12 servers in environment are vulnerable; 3) Ransomware group ABC leaked data from a similar agency, indicating interest in our sector,” and so forth. It will highlight any required actions (like patch deployments or heightened monitoring) with risk assessments and even link to internal asset lists that are impacted. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)
*   **Responsively:** When an alert or incident comes in, orchestration will have the TI Agent enrich it. Suppose the Alert Triage Agent flags an alert about unusual outbound traffic to `evil.ru` – the TI Agent would be tasked to pull intel on that domain (maybe it finds it’s associated with known malware C2). The agent feeds this info back into the incident (perhaps attaching a note in Sentinel or informing the analyst via Copilot chat). Similarly, if the Threat Hunting Agent finds a suspicious file, the TI Agent can automatically run that hash through threat databases.
*   **Collaboration:** The TI Agent often triggers the Threat Hunting Agent: if fresh intel arrives about a specific IOC in use, the TI Agent (via orchestrator) can prompt a hunt, *“Search all logs for any sign of IOC X”*. It also works with the IR Agent by providing threat profiles during an incident (e.g., “The adversary we’re dealing with typically also tries to exfiltrate data – check for that”). In a coordinated workflow, the TI Agent ensures **no intelligence is siloed** – everything relevant gets to the people or agents who need it.

**Customization & Extension:** Organizations can customize the Threat Intelligence Agent by selecting which sources of intel to include and setting priority on certain types of intel. For example, a government SOC might prioritize intelligence from CISA or MSFT’s nation-state threat reports, whereas a financial company might feed in FS-ISAC alerts. Azure AI Foundry allows adding custom connectors, so one could plug a proprietary threat feed API into the agent. The agent’s logic for relevance can be tuned – e.g., if the org only cares about threats targeting North America, filters can be applied. Natural language instructions can also refine its output; an admin could ask it, *“Only alert me if a new vulnerability has a CVSS score above 9 and we have assets that match.”* The agent could learn to suppress less critical advisories accordingly. Moreover, the TI Agent can be extended to integrate with **ticketing systems** or workflows: if a relevant threat intel item appears, it might automatically create a task for the vulnerability management team (via ServiceNow or Azure DevOps) to review and patch, demonstrating that it’s not just informing but also initiating risk mitigation actions. In essence, the TI Agent is highly extensible – any new source of truth about threats can be wired in, and any way the organization wants to consume intel (dashboards, reports, automated actions) can be enabled through scripting and orchestration.

***

## Orchestration Layer: Managing Agent Collaboration

To harness the full power of these specialized agents, a robust **Orchestration Layer** is essential. This layer acts as the **conductor** that coordinates the various agents (and integrates human input as needed), ensuring that the right tasks happen at the right time, and that information flows between agents smoothly. Key aspects of the orchestration layer include:

*   **Triggering and Workflow Logic:** The orchestrator determines when to invoke each agent. This could be event-driven (for example, a new high-severity Sentinel incident triggers a sequence: Triage Agent -> if confirmed, then IR Agent and TI Agent in parallel -> then Hunting Agent) or schedule-driven (e.g., run threat hunting tasks every night). It can implement complex workflows with branching: if the triage agent classifies something as benign, perhaps end the workflow; if malicious, proceed to containment. In Microsoft Azure, this logic can be built using **Azure Logic Apps or Azure Functions** – these provide a way to call each agent’s functionalities (via APIs or SDK) in sequence and handle conditional logic. In fact, advanced users can create custom Security Copilot agents by chaining tasks in this manner: e.g., *pull logs -> cross-reference threat feed -> create a ticket*, as one pipeline. The orchestrator essentially encodes the SOC’s playbooks across agents. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)
*   **Context Sharing:** A critical role of orchestration is passing context between agents. The output of one agent often becomes the input of another. For instance, if the Alert Triage Agent identifies an incident with certain IOCs, the orchestrator will pass those IOCs to the Threat Hunting Agent (*via parameters or a shared knowledge store*) to start a hunt. Azure AI Foundry’s **Connected Agents** feature facilitates this by enabling a *main agent* to maintain a conversation or state and use natural language to delegate tasks to sub-agents, carrying over context automatically. This means the orchestrator doesn’t always have to be a complex piece of code; it can be a higher-level agent itself that “knows” the abilities of sub-agents and requests their help in an intelligent way. In other setups, a simple approach might store shared data in a **Cosmos DB** or memory, accessible by all agents, or use Sentinel’s incident fields as a medium (agents updating the incident with notes that other agents read). [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/) [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/azure-ai-foundry-blog/building-a-digital-workforce-with-multi-agents-in-azure-ai-foundry-agent-service/4414671)
*   **Parallelism and Scalability:** Orchestration can invoke agents in parallel when appropriate. In a fast-moving attack, for example, the IR Agent might start containment while the Threat Intel Agent is fetching intel – no need to wait sequentially. Or multiple instances of the Threat Hunting Agent could run different hunts simultaneously on large data sets. The orchestrator manages these parallel tasks and collects results. Azure Logic Apps supports parallel branches, and Azure Functions can be stateless and concurrent, enabling a scalable multi-agent response.
*   **Decision-Making & Policy Enforcement:** The orchestrator is configured with the organization’s policies on automation. It decides when to auto-escalate to a human. For instance, it might allow the IR Agent to automatically isolate a single endpoint, but require human approval to isolate an entire subnet or to disable a high-privilege account. These rules are built into the workflow. Additionally, with AI in the loop, the orchestrator could even use an LLM-based agent to make judgements on ambiguous situations (though generally, critical decisions are best left to explicit rules or humans). The orchestrator is also responsible for **escalation paths**: if an agent fails to handle something (e.g., the hunting agent finds something huge that indicates a widespread breach), the orchestrator might page the on-call security engineer or trigger an incident bridge.
*   **Monitoring and Feedback:** The orchestration layer monitors the performance of each agent and the overall outcome. It logs the steps taken in each scenario (important for auditing, especially in regulated environments). Moreover, it can implement feedback loops: e.g., after an incident is closed, orchestrator could prompt the Threat Intelligence Agent to update the knowledge base with new learnings, and the Alert Triage Agent to learn from any false positives/negatives observed. In Azure AI Foundry’s multi-agent workflows, there are features for state management, error handling, and even human-in-the-loop breaks for long-running processes, which can be leveraged for reliability. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/azure-ai-foundry-blog/building-a-digital-workforce-with-multi-agents-in-azure-ai-foundry-agent-service/4414671), [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/azure-ai-foundry-blog/building-a-digital-workforce-with-multi-agents-in-azure-ai-foundry-agent-service/4414671)

**Implementation Options:** There are two notional ways to implement the orchestration in Azure:

1.  **Custom Orchestration with Azure Functions/Logic Apps:** Here, one might use a combination of Azure Functions (for custom logic) and Logic Apps (for visual workflow and integration connectors) to coordinate agents. For example, a Logic App could be triggered by a Sentinel alert, call an Azure OpenAI prompt function to run the Triage Agent (via Copilot’s API), then run different steps depending on the classification result. This approach offers fine-grained control and the ability to intermix any service or API call (including third-party systems or sending notifications). It requires the solution developer to design the workflows, but it’s fully customizable. Microsoft’s guidance shows that advanced users indeed mix these tools to build tailored security automation. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)
2.  **Azure AI Foundry Agent Orchestration:** Azure AI Foundry’s Agent Service provides a higher-level, agent-centric orchestration. You can define a **main orchestrator agent** which uses natural language planning to delegate to our four specialized agents (which would be implemented as individual Foundry agents). Foundry’s “Connected Agents” feature means the main agent can simply have a prompt like: *“If an alert comes in, ask the Triage Agent to analyze it. If it’s critical, tell the IR Agent to contain the threat and the TI Agent to get intel. Meanwhile, ask the Hunting Agent to check for related issues.”* The Foundry platform handles the routing of tasks to the right agents without explicit coding. It also provides the Multi-Agent Workflow capability for stateful, long-running coordination with visual design tools. This can simplify development, though it works best when all agents are in the Foundry ecosystem. The orchestrator agent or workflow can easily be extended by adding new sub-agents for new tasks without overhauling the whole system. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/azure-ai-foundry-blog/building-a-digital-workforce-with-multi-agents-in-azure-ai-foundry-agent-service/4414671) [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/azure-ai-foundry-blog/building-a-digital-workforce-with-multi-agents-in-azure-ai-foundry-agent-service/4414671), [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/azure-ai-foundry-blog/building-a-digital-workforce-with-multi-agents-in-azure-ai-foundry-agent-service/4414671)

In practice, organizations might use a hybrid: for critical real-time paths, a Logic App or Sentinel Playbook ensures certain actions happen rapidly; concurrently, an orchestrator agent in Foundry might be managing a more conversational or adaptive process (like interacting with an analyst via Copilot, or handling a complex multi-step investigation across hours).

**Agent Collaboration & Escalation:** Under orchestration, the agents function like a team in play: the **Triage Agent** is the “scout” that calls out threats; the **Threat Intel Agent** is the “advisor” providing background info; the **Threat Hunting Agent** is the “detective” searching the premises; and the **Incident Response Agent** is the “firefighter” dousing the flames. The orchestrator is the “leader” that ensures each member knows when to act. If the situation exceeds what the automated team can handle or requires discretion, the orchestrator will escalate to human operators – effectively saying, *“We need a manager on this scene now.”* For example, in an insider threat case where employment consequences are involved, the system might automatically gather all evidence (access logs, contextual analyses via agents) and then hand off to a human investigator and HR team for final action, rather than the IR Agent directly disabling the employee account without approval.

***

## Collaborative Scenario Examples

To illustrate how these agents work together under orchestration, let’s walk through a few complex threat scenarios:

**1. Multi-Stage Intrusion (APT Attack)** – *Scenario:* An advanced persistent threat actor gains initial access through a phishing email and then moves laterally within a government network to exfiltrate sensitive data.

*   **Initial Compromise Detected:** A user opens a malicious email attachment. Defender for Endpoint flags suspicious PowerShell activity on the user’s PC. This alert goes to Sentinel.
*   **Alert Triage Agent** kicks in, correlating this with a couple of other alerts (an unusual outbound connection from the same PC, and an Azure AD risky sign-in for the user). It recognizes a pattern suggesting a serious breach and escalates a high-priority incident. It provides a summary: “Possible compromise of <User> via phishing – malware detected and connecting to external IP.” [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)
*   The orchestrator immediately triggers the **Incident Response Agent**. That agent isolates the user’s PC from the network within seconds, and resets the user’s Azure AD account password (containment). It also pulls a memory dump from the machine for analysis.
*   Next, the orchestrator engages the **Threat Intelligence Agent** to analyze the malware hash and external IP. The TI Agent finds that the IP is associated with a known nation-state group and the malware appears to be a remote access trojan used by that group. It briefs the team (and the IR Agent) that *“This looks like Group X, who typically also use credential dumping and data exfiltration after initial access”*. It also alerts that Group X has targeted government agencies recently with similar tactics. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)
*   Given this intel, the orchestrator asks the **Threat Hunting Agent** to perform a sweep: Are there signs of credential dumping or lateral movement on other systems? The Hunting Agent uses natural language-driven queries to search logs: it checks domain controller logs for abnormal account usage, scans other hosts for the presence of the same malware hash, and looks at outbound traffic logs for the past week for large data transfers to unusual destinations.
*   The Threat Hunting Agent discovers that the attacker’s account (the phished user) attempted to access an HR database server and that another machine on the network started communicating with an external server overnight (possibly data exfiltration from a scheduled task). It flags these findings.
*   The orchestrator, upon this discovery, re-engages the **Incident Response Agent**: now that agent contains the additional affected server (isolating the HR database server and terminating the suspicious process on the second machine). The IR Agent also uses the intel about credential dumping to proactively reset or lock other accounts that showed signs of usage by the attacker.
*   Meanwhile, the orchestrator informs a human incident commander (because this is a severe nation-state level incident). The various agent outputs (triage summary, threat intel report, hunt findings, actions taken) are compiled automatically into a timeline and report for the incident commander. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)
*   In the after-action phase, the **Threat Intelligence Agent** adds the new indicators (attacker IP, hashes, techniques) into the organization’s threat intel database and shares them (appropriately sanitized) with government security partners. The **Alert Triage Agent** is updated to watch for similar patterns in the future (learning from this incident), and the **Threat Hunting Agent** might schedule periodic hunts for any leftover footholds. The orchestrator ensures these knowledge updates happen once the incident is closed.

**2. Coordinated Phishing Campaign** – *Scenario:* A wave of phishing emails hits the organization, some employees report them, and one user likely clicked and entered credentials, leading to a potential account compromise.

*   Employees use the “Report Phish” button in Outlook, which sends the emails to Microsoft for analysis. Defender for Office 365 generates alerts for these phishing submissions.
*   The **Alert Triage Agent** processes the influx of similar alerts. Using grouping logic, it recognizes that dozens of alerts have the same email sender and subject, indicating a campaign. It clusters them into one meta-incident “Phishing campaign targeting org – 50 reports” and marks it as high importance (since even one successful phish can be dangerous). It automatically closes a few that appear to be false positives (e.g., misreported spam) and provides a rationale for the cluster: “All these emails contain a link to `login-example.azurewebsites.net` which is likely a fake login page.”
*   The **Threat Intelligence Agent** is invoked to investigate that phishing URL/domain. It finds that the domain was newly registered and is flagged on an open phishing feed. It notes the domain is impersonating the Azure AD login page. TI Agent reports: “Phishing page hosted on AzureWebsites – likely stealing credentials. Known in phishing feed X.” It also checks if any credentials from the org have appeared on dark web paste sites (a possible outcome of successful phishing).
*   The orchestrator triggers an **Incident Response Agent** action: since credential theft is possible, it has Entra ID force a password reset or token revocation for the one user account that the logs show clicked the link (the one that had an unusual login right after the email). It also uses Exchange Online Powershell to purge the phishing email from all mailboxes (so no one else clicks it).
*   In parallel, the orchestrator uses the **Threat Hunting Agent** to look for any signs of further activity from the possibly compromised account or others: e.g., unusual login attempts, changes in mailbox rules (attackers often set forwarding rules), or the presence of the phishing domain in web proxy logs. The hunting agent finds that the one user’s account did indeed create an anomalous inbox rule (forwarding emails externally) – a hallmark of compromised O365 accounts.
*   Upon this finding, the IR Agent, under orchestration, disables that user account entirely and notifies IT to work with the user for account recovery. It also removes the malicious forwarding rule via Exchange admin API.
*   Once contained, the **Alert Triage Agent** can downgrade the incident’s severity (no further spread) but keep it open for monitoring. The **Threat Intelligence Agent** might generate a quick report to management about this campaign (how many attempted, how many blocked, impact) for awareness.
*   The orchestrator may also engage a **Communication Agent** (if one exists, or simply prompt a security analyst) to send an organization-wide advisory: “We saw a phishing campaign today, please be vigilant; if you clicked the attachment, contact IT.” This scenario shows the agents handling a flood of related alerts, automating immediate protective measures, and scouring for any breach, all in a matter of minutes – a task that would overwhelm a human-only team.

**3. Insider Threat Detection** – *Scenario:* An internal user with privileged access is suspected of exfiltrating sensitive data (a potential insider risk incident).

*   Microsoft Purview (Insider Risk Management) or Sentinel generates an alert: user *John Doe* downloaded 500 sensitive files and used a USB drive on his workstation, off-hours. This triggers suspicion of data theft.
*   The **Alert Triage Agent** in this context is tuned to prioritize insider-related alerts (given the organization’s priorities). It marks this incident as critical, citing *“User downloaded unusually large number of confidential files (Project Obsidian IP) outside business hours”*. Because insider incidents can be nuanced, the agent includes an explanation referencing the sensitivity labels on the files and the off-hours activity. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041)
*   The orchestrator calls on the **Threat Intelligence Agent**, although external threat intel is less relevant for an insider. Here the TI Agent might pull internal context instead: it checks John’s HR profile and notes he gave two weeks’ notice of resignation (hypothetically) – an important context. It also might retrieve any past security incidents or anonymized insider risk cases similar to this. The agent finds a pattern match with a known insider tactic (downloading IP before leaving) and alerts that this behavior is high risk.
*   The **Threat Hunting Agent** is tasked to investigate John’s activities across systems. It queries file access logs, email logs, and endpoint logs: Did John also email any of these files out? Did he use any cloud storage apps? Did any other user account start doing similar things (in case of collusion)? The agent might discover that John also attempted to access an unrelated confidential project that he typically shouldn’t (indicating potential broad interest in sensitive data) and that he used an admin account to try to disable DLP monitoring (if he had that ability). These findings deepen the concern.
*   Because this is an insider and there are legal considerations, the **Incident Response Agent** operates in a more cautious mode. It might isolate John’s device or cut off VPN access to prevent further data exfiltration, but not immediately disable his accounts without authorization from HR/Legal. The orchestrator can enforce this: perhaps it automatically involves a human approval step. In this case, the orchestrator sends an alert to the Insider Risk Management team and HR, attaching the compiled evidence from all agents (file logs, timings, context) for review.
*   Upon approval, the IR Agent then locks John’s accounts and begins a forensic preservation (collecting his emails and device image for investigation). It ensures all of John’s sessions are terminated. If the evidence threshold is high, it might also trigger an alert to physical security (if on-prem) or managers to be present.
*   Throughout, the orchestrator manages communication between agents: the Triage Agent’s initial summary, enhanced by TI Agent context (e.g., John’s resignation status), plus hunting findings, all feed into a comprehensive incident report. The TI Agent might not add external intel here, but it could note if, say, any of the files correspond to known leaked datasets outside (hoping not).
*   After containment, the **Threat Intelligence Agent** might turn its focus outward – monitoring dark web or paste sites in subsequent days to see if John (or someone) leaks the data. The orchestrator could schedule the TI Agent to keep an eye on that and report back any hits.
*   This scenario highlights that the orchestrator can also manage *what not to automate*. It kept human decision points for the insider case. But it leveraged the agents to gather a 360-degree view (from digital behavior to contextual info) much faster than a manual investigation. The Alert Triage Agent and Threat Hunting Agent together provided a clear picture of activities, which the Incident Response Agent used to take measured actions, all under oversight.

***

## Agent Capabilities and Integration Summary

The table below summarizes each of the four AI agents in the Agentic SOC layer, their key capabilities, the data sources they use, and how they integrate with Microsoft security services:

| **AI Agent**                  | **Key Capabilities** (What it does)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | **Key Data Sources & Dependencies** (What it uses)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | **Integration Points** (MS Services & Tools)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ----------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Alert Triage Agent**        | - *Prioritize & classify alerts*: Analyzes alert details with AI to flag high-risk incidents first and filter out noise [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041).<br>- *Correlate related alerts*: Groups multiple alerts into one incident, deduplicates repetitive ones.<br>- *Explain & escalate*: Provides rationale for alert priority and escalates critical incidents to response [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041).<br>- *Learn & adapt*: Incorporates analyst feedback to improve prioritization over time [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041). | - **SIEM Alerts**: Ingests from Microsoft Sentinel (analytics rule triggers, incidents) and Defender alerts (endpoint, email, identity) [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/).<br>- **Context Data**: Asset value (CMDB), user info (Entra ID), data sensitivity (Purview labels) to gauge impact.<br>- **Generative AI**: Azure OpenAI to interpret alert context and generate summaries/explanations. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoft-security-blog/announcing-alert-triage-agents-in-microsoft-purview-powered-by-security-copilot/4396041)<br>- **Feedback Store**: Incident outcomes (false positive/true positive) for learning.                                                                                                                                | - **Microsoft Sentinel**: Integrated as an automated incident triage layer (could update incident tags/status via Sentinel API). [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)<br>- **Defender XDR**: Receives alerts from Defender for Endpoint, Office 365, Cloud Apps, etc., via Sentinel or Graph APIs. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)<br>- **Security Copilot**: Uses Copilot’s LLM to summarize incidents and rationale for analysts. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)<br>- **Teams/Email**: Can send high-priority alert notifications with summaries to SOC channels.                                                                                                                                                                                                             |
| **Threat Hunting Agent**      | - *Proactive hunting*: Queries logs and telemetry for anomalies or IOCs without waiting for alerts. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)<br>- *Natural language interface*: Converts plain language questions into KQL or other query languages to search data [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187).<br>- *Pattern analysis*: Identifies suspicious patterns across users or systems (e.g., lateral movement, privilege abuse) and surfaces hidden threats.<br>- *Investigation support*: Pivots through related data during incident investigations for a full scope view.                                                                                                                                                                        | - **Log & Event Data**: Sentinel’s Log Analytics (security events from endpoints, network devices, Azure logs, etc.) – potentially large-scale, multi-month data. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)<br>- **Behavior Analytics**: Baselines of normal user/entity behavior (could use Defender TI or custom ML models for anomalies).<br>- **Threat Intel**: IOCs and TTPs from TI Agent to guide hunts (e.g., specific indicators to search for).<br>- **Azure OpenAI**: NLP engine to interpret analyst questions and formulate queries; also to summarize findings.                                                                                                                                                                                                                                                               | - **Microsoft Sentinel**: Executes KQL queries on Sentinel data; can create Sentinel incidents or dashboards from hunt findings. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)<br>- **Defender for Endpoint**: Direct hunting in endpoint telemetry (via Advanced Hunting API) for malware, processes, etc.<br>- **Azure OpenAI (Security Copilot)**: Enables the NL to KQL hunting experience and interactive chat-driven hunts [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187).<br>- **Azure ML**: Optional integration for custom anomaly detection models or notebooks for advanced hunts.                                                                                                                                                                                                                                |
| **Incident Response Agent**   | - *Automated containment*: Isolates compromised devices, disables accounts, blocks malicious elements in real-time [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/).<br>- *Remediation & recovery*: Removes threats (kill processes, delete files), applies patches or resets credentials, and restores systems to normal operation.<br>- *Playbook execution*: Runs multi-step response workflows (notifications, backups, evidence collection) consistently and quickly.<br>- *Guided response*: Recommends actions to analysts and can incorporate org’s IR procedures into its suggestions [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187).                                                                                                                                                                                                | - **Incident Context**: Input from Sentinel incidents (affected hosts, users, attack scope) to know what to target.<br>- **Tool APIs**: Microsoft Defender APIs (endpoint isolation, file quarantine, etc.), Entra ID (account lockdown), Intune or Azure (device wipe), Azure Firewall or MDO (block indicators) – to execute actions. [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)<br>- **Knowledge Base**: Internal SOPs and checklists (so it follows compliance rules) [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187); past incident learnings to avoid repeat mistakes.<br>- **Communication Channels**: Teams/Email to post updates or request approvals from staff (for human-in-loop). | - **Sentinel SOAR (Logic Apps)**: Many actions implemented as Logic App playbooks the agent triggers (for containment, ticketing, etc.).<br>- **Microsoft Defender Suite**: Tight integration to perform response in endpoint, identity, cloud app, email (e.g., isolate machine in Defender for Endpoint, purge phish in Defender for Office). [\[itssecurit...hmike.blog\]](https://itssecuritydaywithmike.blog/security-copilot-agents-integration/)<br>- **Azure AD / Entra**: Directly disable or reset user accounts, adjust conditional access policies via Graph.<br>- **ITSM (e.g., ServiceNow)**: Create incident tickets or change requests if needed for tracking and escalation.<br>- **Security Copilot**: Uses Copilot to generate incident summaries and checklists, aligning with organizational SOPs for consistency [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187). |
| **Threat Intelligence Agent** | - *Intel aggregation*: Collects latest threat intelligence (IOCs, threat actor TTPs, vulnerabilities) from Microsoft feeds and others, and distills relevant items [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187).<br>- *Enrichment*: Adds context to alerts/incidents (e.g., “IP X is known malware C2 server”) to inform decision-making swiftly.<br>- *Threat alerts*: Proactively warns about emerging threats and maps them to the organization’s exposure (which assets/users might be affected).<br>- *Reporting & knowledge*: Provides threat briefings, maintains a knowledge base of threat profiles and past incident histories for reference.                                                                                                                                                                                                                                                             | - **External Feeds**: Microsoft Threat Intelligence (global threat data), ISAC feeds, open-source feeds (OSINT), vulnerability advisory feeds (e.g., MSRC, CVE databases).<br>- **Internal Intel**: Sentinel Threat Intelligence Indicators table (if populated), internal incident DB, sensor data (honeypots).<br>- **Azure Cognitive Search**: Index of threat reports and documentation (enables quick search in a large corpus of intel).<br>- **Azure OpenAI**: Summarization of intel reports, Q\&A on threat data, and drafting briefings in natural language [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187).                                                                                                                                                       | - **Defender Threat Intelligence** (and Microsoft 365 Defender): Provides seamless integration of Microsoft’s curated intel and risk assessments into the agent’s dataset. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)<br>- **Sentinel TI Integration**: Ingests and exports IOCs via Sentinel’s TI platform, allowing automated matching against log data and sharing of new indicators.<br>- **Azure OpenAI (Copilot)**: Powers the interactive briefings and explanations, e.g., an analyst can ask “What is known about Actor XYZ?” and get a synthesized answer from the agent.<br>- **Vulnerability Management**: Feeds into Defender Vulnerability Management by flagging which new threats exploit which CVEs, helping prioritize patching.<br>- **Teams/Email**: Distributes threat intel advisories or daily digests to SOC staff or relevant stakeholders automatically.                  |

**Table: AI Agents in the Agentic SOC Layer – their functions, data inputs, and integration with Microsoft Security technologies.** Each agent is modular; organizations can deploy the ones they need and extend them. Together, they form a cohesive system that enhances the SOC’s capabilities across the board – from spotting threats faster (TI and Triage agents) to investigating deeper (Hunting agent) to responding more quickly and consistently (IR agent).

***

Each of these AI agents and the orchestration that binds them represent a powerful evolution in SOC design. By delegating specialized tasks to AI "team members," a security team can handle threats that are **faster, more complex, and more numerous** than ever before. The **Agentic SOC Layer** leverages Azure’s state-of-the-art AI (like Security Copilot’s GPT-4-based brains and Foundry’s agent framework) on top of proven Microsoft security tools (Sentinel, Defender) to create an intelligent, adaptive defense system. Importantly, this system is customizable and extensible – security teams remain in control, tuning the AI agents to their environment and comfort level. Complex attacks such as multi-stage intrusions, widespread phishing waves, or malicious insider events can be addressed in a coordinated, rapid manner that was previously very difficult to achieve. The result is a SOC that is not only *reactive* but also *proactive and predictive*, with AI agents working alongside human analysts to anticipate threats, reduce dwell times, and enforce security at machine speed. In summary, the Agentic SOC Layer transforms the traditional SOC into a more unified, **autonomous-but-supervised** immune system for the organization’s digital assets – one where mundane tasks are offloaded to AI, and the human experts can focus on higher-level strategy and truly novel threats, confident that the AI is handling the rest. [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187), [\[techcommun...rosoft.com\]](https://techcommunity.microsoft.com/blog/microsoftthreatprotectionblog/security-copilot-for-soc-bringing-agentic-ai-to-every-defender/4470187)
